# AWSネットワークの構築

## ネットワークの概念
### リージョン
* 使えるサービスが異なる

### AZ
* 独立したデータセンター、各リージョンに2つ以上が物理的に離れて存在する

### VPC
* AWS上に仮想ネットワークを作成できるサービス
* リージョン上に作成する

### サブネット
* VPCの中を細かくネットワークを分ける
* VPCをサブネットで分割して使いやすくするメリットはAZを分けて冗長化できる点とインターネットに公開しないネットワークの作成などセキュリティ的な点
* AZの中に作成できる
* サブネットの中にサーバを構築する

## IPアドレスを決める
### IPアドレスの特徴
* IPアドレスは32ビットの整数値で構成されている
* 8ビットずつの4組みに分けてピリオドを入れて10進数で表現する
* ネットワーク部とホスト部で分けられる

### パブリックIPアドレス
* インターネット接続用で1意になっている

### プライベートIPアドレス
* インターネットで使用されないから重複OK

### ネットワーク部とホスト部について
* ネットワーク部は学校でいうクラス
* ホスト部はクラスでいう出席番号
* つまり、どのネットワークに存在している（ネットワーク部）端末（ホスト部）かを判断できる

### CIDR表記
* IPアドレスの後ろに「/」を書き、その後ろにネットワーク部が先頭から何ビット目までなのかを記載する
* 例）192.168.128.0/24 -> 先頭から24ビット目までがネットワーク部「192.168.128」まで

### サブネットマスク表記
* IPアドレスの後ろに「/」を書き、ネットワーク部を表すビットと同じ部分を1に、ホスト部を表すビットと同じ部分を0にする
* 例）192.168.128.0/255.255.255.0

### ルーターとは
* IPアドレスがどのデバイスに紐づいているかとどのネットワークに所属しているかを管理している

### ルートテーブル
|宛先IPアドレス|接続ルーター|意味|
|---|---|---|
|10.0.1.0/24|local|ルーターA、つまり自身のネットワーク|
|10.0.2.0/24|ルーターB|ルーターBが管理するネットワーク|
|0.0.0.0/0|ルーターC|デフォルトルート、ルートテーブルに登録されているどのアドレスにも一致しない場合の経路|

## ネットワーク構築
1. VPC作成
1. サブネット作成
1. インターネットゲートウェイ作成
1. ルートテーブル作成

* VPCのルートはデフォルトで自身の向け先以外を破棄する設定なので0.0.0.0/0でそれ以外をインターネットゲートウェイにむけるとインターネットに接続できるようになり、サーバに必要なツールなどをインストールできるようになる

## VPC設計のポイント
* プライベートIPアドレス範囲から指定する
* 変更できないので、大きめに設定しておく（/16が推奨）
* 重複しないIPアドレスを意識する
* 異なるシステムの場合は、管理が煩雑になるのでアカウントを分ける

## サブネット設計のポイント
* IPアドレスは大きめに設定する（/24が推奨）
* 割り当てられるルートテーブルは1つ
