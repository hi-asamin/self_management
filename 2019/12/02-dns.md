# EC2 Webサーバ構築

## ファイアウォールとは
* 不正アクセスを遮断し、必要な通信を許可する

## ファイアウォールの設定
* セキュリティグループ = ファイアウォール
* サーバへ入ってくる通信（インバウンド）のポートは必要なものに限定して解放する
* サーバから出て行く通信（アウトバウンド）のポートは多くの場合全て解放している

## IPアドレスを固定する（Elastic IPアドレス）
* EC2インスタンスは起動・停止すると別のIPアドレスが割り当てられる
* 固定のグローバルIPを入手してインスタンスに紐づける

### Elastic IPアドレス注意点
* 紐づけられているインスタンスが起動中は無料
* EC2インスタンスへの紐づけがない場合や、停止中の場合は課金となる(Elastic IPアドレスを解放するべき)

## ドメイン登録
### ドメインの構造
* ピリオドで区切られた構造をしている
例）www.example.co.jp -> 第4レベルドメイン.第3レベルドメイン.第2レベルドメイン.トップレベルドメイン
* 各レベルのドメインで同じ名前は登録不可なので、全てのドメインはユニーク
|管理組織|役割|具体的な組織|
|---|---|---|
|ICANN|ドメイン全体を管理（IPアドレスも管理している非営利法人）、トップレベルドメインの管理者を任命している、新しいドメインを作る決定権もある||
|レジストリ|トップレベルドメインを管理、レジストらに卸す、1つのレジストリは1つのトップレベルドメインを管理している（ドメインの一意性を保つため）|ICANNに管理を任命された事業者(.com)|
|レジストラ|リセラに卸す、一般消費者に販売、ドメイン登録事業者|ドメインを仕入れた事業者お名前.comなど|
|リセラ|一般消費者に販売、再販事業者（レジストラから仕入れ）|ドメインを仕入れた事業者|

## DNSについて
### DNSとは
* Domain Name System
* ドメイン名をIPアドレスに変換する
* ネームサーバとフルリゾルバの2つから構成されている

### ネームサーバとは(電話帳のイメージ)
* ドメイン名とそれに紐づくIPアドレスが登録されているサーバー
* ドメインの階層ごとにネームサーバが配置され、そのネームサーバが配置された階層のドメインに関する情報を管理する

### フルリルバとは
* 「このドメインに紐づくIPアドレスを教えて」と問い合わせると、色々なネームサーバに聞いてIPを調べて教えてくれるサーバ

### リソースレコード
* DNSが管理しているもの
リソースレコードのタイプ|内容||
|---|---|
|Aレコード|ドメインに紐づくIPアドレス|
|NSレコード|ドメインのゾーンを管理するネームサーバ|
|MXレコード|ドメインに紐づくメール受信サーバ|
|CNAME|ドメインの別名でリソースレコードの参照先|
|SOA|ドメインのゾーンの管理情報|
